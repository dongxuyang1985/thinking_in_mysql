-- 案例分析
-- 创建销量表emp_sales
CREATE TABLE emp_sales(
  emp_id     INTEGER NOT NULL, -- 员工编号
  sale_year  INTEGER NOT NULL, -- 销售年份
  sale_month INTEGER NOT NULL, -- 销售月份
  amount     NUMERIC(8,2) NOT NULL, -- 销售金额
  CONSTRAINT pk_emp_sales PRIMARY KEY (emp_id, sale_year, sale_month)
);

-- 生成测试数据
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (19,2021,1,15672.53);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (20,2021,1,11160.46);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (21,2021,1,13763.75);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (22,2021,1,11210.34);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (23,2021,1,14610.88);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (24,2021,1,13747.64);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (25,2021,1,12816.20);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (19,2021,2,14413.77);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (20,2021,2,14266.04);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (21,2021,2,16984.42);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (22,2021,2,15272.97);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (23,2021,2,16103.39);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (24,2021,2,15465.84);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (25,2021,2,14824.55);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (19,2021,3,14352.10);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (20,2021,3,15116.63);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (21,2021,3,13766.24);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (22,2021,3,15410.53);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (23,2021,3,16377.44);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (24,2021,3,14856.07);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (25,2021,3,16371.59);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (19,2021,4,16660.24);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (20,2021,4,17730.30);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (21,2021,4,17898.77);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (22,2021,4,18044.52);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (23,2021,4,18061.82);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (24,2021,4,18744.78);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (25,2021,4,14441.28);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (19,2021,5,19108.85);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (20,2021,5,19466.56);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (21,2021,5,16984.75);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (22,2021,5,17029.43);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (23,2021,5,18389.50);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (24,2021,5,15220.30);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (25,2021,5,18506.34);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (19,2021,6,20154.83);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (20,2021,6,17350.87);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (21,2021,6,16034.62);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (22,2021,6,16308.70);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (23,2021,6,19910.08);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (24,2021,6,16072.75);
INSERT INTO emp_sales (emp_id,sale_year,sale_month,amount) VALUES (25,2021,6,18373.68);
